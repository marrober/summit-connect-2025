apiVersion: triggers.tekton.dev/v1alpha1
kind: EventListener
metadata:
  name: travel-ci-pipeline-listener-hotels
spec:
  serviceAccountName: pipeline
  triggers:
  - name: github-listener
    interceptors:
      - ref:
          name: "github"
          kind: ClusterInterceptor
          apiVersion: triggers.tekton.dev
        params:
        - name: "addChangedFiles"
          value:
            enabled: true
      - ref:
          name: cel
        params:
        - name: "filter"
          value: 'header.match("X-GitHub-Event", "push") && extensions.changed_files.matches("src/travels/travel_agency/hotels")'    
        - name: "overlays"
          value:
          - key: branch
            expression: "body.ref.split('/')[2]"
    bindings:
      - ref: travel-ci-hotels-binding
    template:
      ref: travel-ci-template-hotels
